SQL> set timing on
SQL> --Actors participated in genre Comedy
SQL> 
SQL> SELECT
  2      nb.primaryname,
  3      sum(case when (tb.startyear >= '2010' AND tb.startyear < '2012') then 1 else 0 end) as "2010-2012",
  4      sum(case when (tb.startyear >= '2012' AND tb.startyear < '2014') then 1 else 0 end) as "2012-2014",
  5      sum(case when (tb.startyear >= '2014' AND tb.startyear < '2016') then 1 else 0 end) as "2014-2016",
  6      sum(case when (tb.startyear >= '2016' AND tb.startyear < '2018') then 1 else 0 end) as "2016-2018",
  7      sum(case when (tb.startyear >= '2018' AND tb.startyear < '2020') then 1 else 0 end) as "2018-2020"
  8  FROM imdb00.name_basics nb,imdb00.title_basics tb,imdb00.title_principals tp
  9  WHERE
 10    nb.nconst = tp.nconst AND
 11    tp.tconst = tb.tconst AND
 12    Lower(nb.primaryname) in ('helen mirren', 'alec baldwin','akshay kumar','deepika padukone') AND
 13    LOWER(tp.category) IN ('actor', 'actress') AND
 14    TB.titletype LIKE 'movie' AND
 15    tb.genres LIKE '%Comedy%'
 16  
 17   GROUP BY nb.primaryname;

PRIMARYNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               2010-2012  2012-2014  2014-2016  2016-2018  2018-2020
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------- ---------- ---------- ---------- ----------
Helen Mirren                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      4          2          1          1          0
Deepika Padukone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  3          2          4          0          0
Akshay Kumar                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      7          6          3          3          3
Alec Baldwin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0          3          2          2          1

Elapsed: 00:00:10.662
SQL> 
SQL>  --Actors participated in genre Drama
SQL> 
SQL> SELECT
  2      nb.primaryname,
  3      sum(case when (tb.startyear >= '2010' AND tb.startyear < '2012') then 1 else 0 end) as "2010-2012",
  4      sum(case when (tb.startyear >= '2012' AND tb.startyear < '2014') then 1 else 0 end) as "2012-2014",
  5      sum(case when (tb.startyear >= '2014' AND tb.startyear < '2016') then 1 else 0 end) as "2014-2016",
  6      sum(case when (tb.startyear >= '2016' AND tb.startyear < '2018') then 1 else 0 end) as "2016-2018",
  7      sum(case when (tb.startyear >= '2018' AND tb.startyear < '2020') then 1 else 0 end) as "2018-2020"
  8  FROM imdb00.name_basics nb,imdb00.title_basics tb,imdb00.title_principals tp
  9  WHERE
 10    nb.nconst = tp.nconst AND
 11    tp.tconst = tb.tconst AND
 12    Lower(nb.primaryname) in ('helen mirren', 'alec baldwin','akshay kumar','deepika padukone') AND
 13    LOWER(tp.category) IN ('actor', 'actress') AND
 14    TB.titletype LIKE 'movie' AND
 15    tb.genres LIKE '%Drama%'
 16  
 17   GROUP BY nb.primaryname;

PRIMARYNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               2010-2012  2012-2014  2014-2016  2016-2018  2018-2020
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------- ---------- ---------- ---------- ----------
Deepika Padukone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  8          3          4          1          1
Helen Mirren                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      4          3          4          1          3
Akshay Kumar                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      5          4          4          5          6
Alec Baldwin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0          2          3          3          3

Elapsed: 00:00:10.575
SQL> 
SQL> 
SQL>   --Actors participated in Any genre
SQL> 
SQL> SELECT
  2      nb.primaryname,
  3      sum(case when (tb.startyear >= '1980' AND tb.startyear < '1991') then 1 else 0 end) as "1980-1990",
  4      sum(case when (tb.startyear >= '1991' AND tb.startyear < '2001') then 1 else 0 end) as "1991-2000",
  5      sum(case when (tb.startyear >= '2001' AND tb.startyear < '2011') then 1 else 0 end) as "2001-2010",
  6      sum(case when (tb.startyear >= '2011' AND tb.startyear < '2021') then 1 else 0 end) as "2011-2020"
  7  FROM imdb00.name_basics nb,imdb00.title_basics tb,imdb00.title_principals tp
  8  WHERE
  9    nb.nconst = tp.nconst AND
 10    tp.tconst = tb.tconst AND
 11    Lower(nb.primaryname) in ('helen mirren', 'alec baldwin','akshay kumar','deepika padukone') AND
 12    LOWER(tp.category) IN ('actor', 'actress') AND
 13    TB.titletype LIKE 'movie'
 14  
 15  GROUP BY nb.primaryname;

PRIMARYNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               1980-1990  1991-2000  2001-2010  2011-2020
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------- ---------- ---------- ----------
Helen Mirren                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     14          8         14         17
Deepika Padukone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0          0         10         18
Akshay Kumar                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0         47         44         34
Alec Baldwin                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      8         16         17         20

Elapsed: 00:00:13.041
SQL> 
SQL> 
SQL> set echo off
