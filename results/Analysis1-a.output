SQL> set timing on
SQL> 
SQL> -- query: list number of movies per year using actor nameid over their career
SQL> -- Parameters actor is "Alec Baldwin" and actress is "Helen Mirren"
SQL> SELECT NB.primaryname||','||TB.startyear||','||COUNT(*)
  2  FROM imdb00.name_basics NB, imdb00.title_principals TP, imdb00.title_basics TB
  3  WHERE NB.nconst = TP.nconst AND
  4        TP.tconst = TB.tconst AND
  5        Lower(NB.primaryname) in ('helen mirren', 'alec baldwin') AND
  6        LOWER(TB.titleType) = 'movie' AND
  7        LOWER(TP.category) IN ('actor', 'actress') AND TB.startyear NOT LIKE '\N'
  8  GROUP BY NB.nconst, NB.primaryname, TB.startyear
  9  ORDER BY NB.primaryname ASC,COUNT(*) DESC;

NB.PRIMARYNAME||','||TB.STARTYEAR||','||COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Alec Baldwin,2016,4
Alec Baldwin,1988,4
Alec Baldwin,1999,3
Alec Baldwin,2005,3
Alec Baldwin,1996,3
Alec Baldwin,2019,3
Alec Baldwin,2003,3
Alec Baldwin,2014,3
Alec Baldwin,1992,3
Alec Baldwin,2006,2
Alec Baldwin,1990,2

NB.PRIMARYNAME||','||TB.STARTYEAR||','||COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Alec Baldwin,2013,2
Alec Baldwin,2012,2
Alec Baldwin,2015,2
Alec Baldwin,2001,2
Alec Baldwin,2009,2
Alec Baldwin,1994,2
Alec Baldwin,2008,2
Alec Baldwin,2017,2
Alec Baldwin,1989,1
Alec Baldwin,1986,1
Alec Baldwin,2000,1

NB.PRIMARYNAME||','||TB.STARTYEAR||','||COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Alec Baldwin,2004,1
Alec Baldwin,1998,1
Alec Baldwin,1997,1
Alec Baldwin,2010,1
Alec Baldwin,1991,1
Alec Baldwin,1993,1
Alec Baldwin,2022,1
Alec Baldwin,2007,1
Alec Baldwin,2011,1
Alec Baldwin,2021,1
Alec Baldwin,2018,1

NB.PRIMARYNAME||','||TB.STARTYEAR||','||COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Helen Mirren,2010,5
Helen Mirren,2009,4
Helen Mirren,2015,3
Helen Mirren,1980,3
Helen Mirren,2019,3
Helen Mirren,2022,3
Helen Mirren,2013,3
Helen Mirren,1984,2
Helen Mirren,2012,2
Helen Mirren,1989,2
Helen Mirren,1990,2

NB.PRIMARYNAME||','||TB.STARTYEAR||','||COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Helen Mirren,1986,2
Helen Mirren,2018,2
Helen Mirren,1994,2
Helen Mirren,1969,1
Helen Mirren,2014,1
Helen Mirren,1972,1
Helen Mirren,1981,1
Helen Mirren,2020,1
Helen Mirren,2017,1
Helen Mirren,1979,1
Helen Mirren,2006,1

NB.PRIMARYNAME||','||TB.STARTYEAR||','||COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Helen Mirren,1976,1
Helen Mirren,2004,1
Helen Mirren,1985,1
Helen Mirren,1987,1
Helen Mirren,1997,1
Helen Mirren,2011,1
Helen Mirren,1991,1
Helen Mirren,1996,1
Helen Mirren,1999,1
Helen Mirren,2000,1
Helen Mirren,2003,1

NB.PRIMARYNAME||','||TB.STARTYEAR||','||COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Helen Mirren,2005,1
Helen Mirren,2008,1
Helen Mirren,1995,1

69 rows selected. 

Elapsed: 00:00:10.559
SQL> 
SQL> --Fav actor is "Akshay Kumar" and actress is "Deepika Padukon"
SQL> SELECT NB.primaryname||','||TB.startyear||','||COUNT(*)
  2  FROM imdb00.name_basics NB, imdb00.title_principals TP, imdb00.title_basics TB
  3  WHERE NB.nconst = TP.nconst AND
  4        TP.tconst = TB.tconst AND
  5        Lower(NB.primaryname) in ('akshay kumar', 'deepika padukone') AND
  6        LOWER(TB.titleType) = 'movie' AND
  7        LOWER(TP.category) IN ('actor', 'actress') AND TB.startyear NOT LIKE '\N'
  8  GROUP BY NB.nconst, NB.primaryname, TB.startyear
  9  ORDER BY NB.primaryname ASC,COUNT(*) DESC;

NB.PRIMARYNAME||','||TB.STARTYEAR||','||COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Akshay Kumar,1994,11
Akshay Kumar,2004,8
Akshay Kumar,1997,7
Akshay Kumar,2006,7
Akshay Kumar,2005,6
Akshay Kumar,2022,6
Akshay Kumar,1993,5
Akshay Kumar,2012,5
Akshay Kumar,1999,5
Akshay Kumar,2019,4
Akshay Kumar,2002,4

NB.PRIMARYNAME||','||TB.STARTYEAR||','||COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Akshay Kumar,2009,4
Akshay Kumar,2010,4
Akshay Kumar,1995,4
Akshay Kumar,2011,4
Akshay Kumar,2015,4
Akshay Kumar,2000,4
Akshay Kumar,2007,4
Akshay Kumar,2017,3
Akshay Kumar,2018,3
Akshay Kumar,2013,3
Akshay Kumar,1996,3

NB.PRIMARYNAME||','||TB.STARTYEAR||','||COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Akshay Kumar,2014,3
Akshay Kumar,1998,3
Akshay Kumar,2016,3
Akshay Kumar,1992,3
Akshay Kumar,2021,3
Akshay Kumar,2001,2
Akshay Kumar,2003,2
Akshay Kumar,1991,2
Akshay Kumar,2008,2
Akshay Kumar,2023,2
Akshay Kumar,2020,1

NB.PRIMARYNAME||','||TB.STARTYEAR||','||COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Akshay Kumar,2008,1
Akshay Kumar,2015,1
Deepika Padukone,2010,5
Deepika Padukone,2013,4
Deepika Padukone,2014,3
Deepika Padukone,2022,3
Deepika Padukone,2015,3
Deepika Padukone,2011,3
Deepika Padukone,2023,3
Deepika Padukone,2017,2
Deepika Padukone,2009,2

NB.PRIMARYNAME||','||TB.STARTYEAR||','||COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Deepika Padukone,2006,1
Deepika Padukone,2020,1
Deepika Padukone,2021,1
Deepika Padukone,2018,1
Deepika Padukone,2012,1
Deepika Padukone,2007,1
Deepika Padukone,2008,1

51 rows selected. 

Elapsed: 00:00:10.587
SQL> 
SQL> set echo off
