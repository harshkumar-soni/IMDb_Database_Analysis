SQL> set timing on
SQL> --MAX movie for actor
SQL> SELECT NB.nconst as nameid,NB.primaryname as name,TB.startyear as year,COUNT(*) as movies
  2  FROM imdb00.name_basics NB, imdb00.title_principals TP, imdb00.title_basics TB
  3  WHERE NB.nconst = TP.nconst AND
  4        TP.tconst = TB.tconst AND
  5        TB.startyear BETWEEN '2010' AND '2020' AND LOWER(TP.category) IN 'actor' AND 
  6        TB.titletype LIKE 'movie'
  7  GROUP BY NB.nconst, NB.primaryname, TB.startyear
  8  ORDER BY COUNT(*) DESC FETCH FIRST ROW ONLY;

NAMEID     NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     YEAR           MOVIES
---------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------- ----------
nm0103977  Brahmanandam                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             2010               32

Elapsed: 00:00:09.526
SQL> 
SQL> 
SQL> 
SQL> --MAX movie for actress
SQL> SELECT NB.nconst as nameid,NB.primaryname as name,TB.startyear as year,COUNT(*) as movies
  2  FROM imdb00.name_basics NB, imdb00.title_principals TP, imdb00.title_basics TB
  3  WHERE NB.nconst = TP.nconst AND
  4        TP.tconst = TB.tconst AND
  5        TB.startyear BETWEEN '2010' AND '2020' AND LOWER(TP.category) IN 'actress' AND 
  6        TB.titletype LIKE 'movie'
  7  GROUP BY NB.nconst, NB.primaryname, TB.startyear
  8  ORDER BY COUNT(*) DESC FETCH FIRST ROW ONLY;

NAMEID     NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     YEAR           MOVIES
---------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------- ----------
nm10992938 Sireah Warden                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            2019               50

Elapsed: 00:00:09.135
SQL> 
SQL> 
SQL> 
SQL> --Male with First 4 Movies
SQL> Select
  2  *
  3  FROM
  4  (SELECT 
  5      NB.nconst AS Nameid,
  6      NB.primaryname AS Name,
  7      TB.startyear AS Year,
  8      COUNT(*) as movies
  9       FROM imdb00.title_principals TP, imdb00.title_basics TB,imdb00.name_basics NB 
 10       WHERE NB.nconst = TP.nconst AND
 11             TP.tconst = TB.tconst AND
 12             TB.startyear BETWEEN '2010' AND '2020' AND LOWER(TP.category) IN 'actor' AND 
 13             TB.titletype LIKE 'movie'
 14      GROUP BY NB.nconst, NB.primaryname, TB.startyear)
 15   WHERE movies = 4 ORDER BY movies, year ASC FETCH FIRST ROW ONLY;

NAMEID     NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     YEAR           MOVIES
---------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------- ----------
nm0048075  Manoj Bajpayee                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           2010                4

Elapsed: 00:00:09.396
SQL> 
SQL> 
SQL>  --Male with last 4 Movies
SQL> Select
  2  *
  3  FROM
  4  (SELECT 
  5      NB.nconst AS Nameid,
  6      NB.primaryname AS Name,
  7      TB.startyear AS Year,
  8      COUNT(*) as movies
  9       FROM imdb00.title_principals TP, imdb00.title_basics TB,imdb00.name_basics NB 
 10       WHERE NB.nconst = TP.nconst AND
 11             TP.tconst = TB.tconst AND
 12             TB.startyear BETWEEN '2010' AND '2020' AND LOWER(TP.category) IN 'actor' AND 
 13             TB.titletype LIKE 'movie'
 14      GROUP BY NB.nconst, NB.primaryname, TB.startyear)
 15   WHERE movies = 4 ORDER BY movies, year DESC FETCH FIRST ROW ONLY;

NAMEID     NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     YEAR           MOVIES
---------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------- ----------
nm0809793  Roger Guenveur Smith                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     2020                4

Elapsed: 00:00:09.450
SQL> 
SQL> 
SQL> --FeMale with First 4 Movies
SQL> Select
  2  *
  3  FROM
  4  (SELECT 
  5      NB.nconst AS Nameid,
  6      NB.primaryname AS Name,
  7      TB.startyear AS Year,
  8      COUNT(*) as movies
  9       FROM imdb00.title_principals TP, imdb00.title_basics TB,imdb00.name_basics NB 
 10       WHERE NB.nconst = TP.nconst AND
 11             TP.tconst = TB.tconst AND
 12             TB.startyear BETWEEN '2010' AND '2020' AND LOWER(TP.category) IN 'actress' AND 
 13             TB.titletype LIKE 'movie'
 14      GROUP BY NB.nconst, NB.primaryname, TB.startyear)
 15   WHERE movies = 4 ORDER BY movies, year ASC FETCH FIRST ROW ONLY;

NAMEID     NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     YEAR           MOVIES
---------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------- ----------
nm1375534  Trisha Krishnan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          2010                4

Elapsed: 00:00:08.926
SQL> 
SQL> 
SQL> --Female with last 4 Movies
SQL> Select
  2  *
  3  FROM
  4  (SELECT 
  5      NB.nconst AS Nameid,
  6      NB.primaryname AS Name,
  7      TB.startyear AS Year,
  8      COUNT(*) as movies
  9       FROM imdb00.title_principals TP, imdb00.title_basics TB,imdb00.name_basics NB 
 10       WHERE NB.nconst = TP.nconst AND
 11             TP.tconst = TB.tconst AND
 12             TB.startyear BETWEEN '2010' AND '2020' AND LOWER(TP.category) IN 'actress' AND 
 13             TB.titletype LIKE 'movie'
 14      GROUP BY NB.nconst, NB.primaryname, TB.startyear)
 15   WHERE movies = 4 ORDER BY movies, year DESC FETCH FIRST ROW ONLY;

NAMEID     NAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     YEAR           MOVIES
---------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------- ----------
nm0386414  Ryôko Hirosue                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            2020                4

Elapsed: 00:00:08.924
SQL> 
SQL> 
SQL> set echo off
